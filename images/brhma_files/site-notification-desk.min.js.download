var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,e){a instanceof String&&(a=String(a));for(var c=a.length,d=0;d<c;d++){var g=a[d];if(b.call(e,g,d,a))return{i:d,v:g}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,e){a!=Array.prototype&&a!=Object.prototype&&(a[b]=e.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,e,c){if(b){e=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var d=a[c];d in e||(e[d]={});e=e[d]}a=a[a.length-1];c=e[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(e,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,e){return $jscomp.findInternal(this,a,e).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function e(a){return a instanceof d?a:new d(function(b,d){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};b.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var c=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){c(a,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var d=a[b];delete a[b];try{d()}catch(h){this.asyncThrow_(h)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var d=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(n){b.reject(n)}};d.prototype.createResolveAndReject_=
function(){function a(a){return function(f){d||(d=!0,a.call(b,f))}}var b=this,d=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};d.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof d)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};d.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(n){this.reject_(n);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};d.prototype.reject_=function(a){this.settle_(2,a)};d.prototype.fulfill_=function(a){this.settle_(1,a)};d.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};d.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var g=new b;d.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};d.prototype.settleSameAsThenable_=function(a,b){var d=this.createResolveAndReject_();try{a.call(b,d.resolve,d.reject)}catch(h){d.reject(h)}};d.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{e(a(b))}catch(r){f(r)}}:b}var e,f,g=new d(function(a,
b){e=a;f=b});this.callWhenSettled_(c(a,e),c(b,f));return g};d.prototype.catch=function(a){return this.then(void 0,a)};d.prototype.callWhenSettled_=function(a,b){function d(){switch(c.state_){case 1:a(c.result_);break;case 2:b(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?g.asyncExecute(d):this.onSettledCallbacks_.push(function(){g.asyncExecute(d)})};d.resolve=e;d.reject=function(a){return new d(function(b,d){d(a)})};d.race=function(a){return new d(function(b,
d){for(var c=$jscomp.makeIterator(a),f=c.next();!f.done;f=c.next())e(f.value).callWhenSettled_(b,d)})};d.all=function(a){var b=$jscomp.makeIterator(a),c=b.next();return c.done?e([]):new d(function(a,d){function f(b){return function(d){g[b]=d;n--;0==n&&a(g)}}var g=[],n=0;do g.push(void 0),n++,e(c.value).callWhenSettled_(f(g.length-1),d),c=b.next();while(!c.done)})};return d},"es6","es3");
var gsid,BROWSER_SUPPORTS=0,dbname="npenglish-store",dbversion="2",ARTICLE_STORE="notification-article-db",UIDSTORE="unique-id-store",service_worker,db,idb_server_id,idb_subscription_id,last_sub_id,idb,db1,db2,redirectUrl,furl={},notificationApi={},licount=0,notnow_clicked=0,notnowclicked_config=5,utmval="utm_source=pn-desktop&utm_medium=pn-article&utm_campaign=pn-cms&ref=pn-cms",version="1.0.24",k,l,myRecord,notfslider,openNotify,notification_source=1,chkcookiepolicy=getUserCookie("cookiePolicy");
0==chkcookiepolicy&&clearTimeout(openNotify);Object.defineProperties(window,{indexedDB:{value:window.indexedDB,writable:!0}});if(/(chrome\/)(\d+\.\d+)/i.test(navigator.userAgent)&&0>navigator.userAgent.search("UCBrowser")&&/(chrome\/)(\d+\.\d+)/i.test(navigator.userAgent)&&0>navigator.userAgent.search("Edge")&&/(chrome\/)(\d+\.\d+)/i.test(navigator.userAgent)&&0>navigator.userAgent.search("UBrowser")){var bversion=new Number(RegExp.$2);42<=parseInt(bversion)&&(BROWSER_SUPPORTS=1)}
1==BROWSER_SUPPORTS&&0!=chkcookiepolicy&&("serviceWorker"in navigator?navigator.serviceWorker.register("/oiframework-sw-web.js?v="+version).then(function(){console.log("Service Worker Registered")}):console.warn("Service workers aren't supported in this browser."));
notificationApi={html_entity_decode:function(a){var b=document.createElement("textarea");b.innerHTML=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");return b.value},shareContent:function(a,b,e,c){return"<div class='article-slider-sharelinks'><a href='javascript:void(0);' class='article-share'><i class='fa fa-share-alt'></i></a><div class='article-slider-num'><span>"+a+"/"+b+"</span></div><div class='article-slider-footer'><a href='#' class='article-slider-facebook' data-url='"+e+"' data-title='"+c+"'><i class='fa fa-facebook'></i></a><a href='#' class='article-slider-twitter' data-url='"+
e+"' data-title='"+c+"'><i class='fa fa-twitter'></i></a><a href='javascript:void(0);' class='article-social-close'>X</a></div></div>"},removeDuplicatesFromObjArray:function(a,b){var e=[];a.reduce(function(a,d){a[b]!==d[b]&&e.push(d);return d},[]);return e},getAllData:function(){var a=window.indexedDB.open(dbname,dbversion);a.onsuccess=function(b){db1=a.result;if(db1.objectStoreNames.contains(ARTICLE_STORE)){b=db1.transaction([ARTICLE_STORE],"readwrite");b.oncomplete=function(a){console.log("Complete")};
b.onerror=function(a){console.log("Error")};var e=b.objectStore(ARTICLE_STORE).getAll();e.onsuccess=function(a){var b=e.result;a=document.getElementById("notification-content");b=notificationApi.removeDuplicatesFromObjArray(b,"url");console.log(b.length);licount=b.length;0==licount?($(".notification-num").hide(),document.getElementById("clear-inbox")&&(document.getElementById("clear-inbox").style.display="none")):(10<licount&&(licount=10),$(".notification-num").text(licount).show(),document.getElementById("clear-inbox")&&
(document.getElementById("clear-inbox").style.display="block"));var c=10>=b.length?parseInt(b.length)-1:9;b=b.reverse();for(var p="",f=0;f<=c;f++)if(""!=b[f].url){var n=b[f].id+"?"+b[f].url;b[f].url=b[f].url+"?"+utmval;var h=parseInt(f)+1,m=parseInt(licount);h=notificationApi.shareContent(h,m,b[f].url,b[f].title);m=b[f].pdate;m=""==m||"undefined"==m||null==m?"":notificationApi.getDateFormat(m);var q=b[f].fdesc;if(""==q||"undefined"==q||null==q)q="";"-1"<b[f].image.indexOf("/100x90x100")?b[f].image=
b[f].image.replace("/100x90x100",""):"-1"<b[f].image.indexOf("/100x90x75")?b[f].image=b[f].image.replace("/100x90x75",""):b[f].image=b[f].image;p+="<li><div class='article-slider-container'><a href='"+b[f].url+"' id='notanchor' data-url='"+n+"' data-index='"+f+"' data-type='article'><div class='article-slider-thumb'><img src='"+b[f].image+"' alt='' /></div><div class='article-slider-details'><h2 class='article-slider-title'>"+b[f].title+"</h2><div class='article-slider-datetime'>"+m+"</div><div class='article-slider-desc'>"+
q+"</div></div></a></div>"+h+"</li>"}b=notificationApi.html_entity_decode(p);a.innerHTML=b;a=$(".article-slider ul li").length;0<a&&(1>=a?$(".article-slider ul li").addClass("oneslide"):3>=a?$(".article-slider ul li").addClass("slide23"):setTimeout(function(){notfslider=$(".article-slider ul").bxSlider({pager:!1,slideMargin:25,slideWidth:320,moveSlides:1,minSlides:3,hideControlOnEnd:!0,infiniteLoop:!1})},3E3),document.getElementById("notf-cont").style.display="block")}}};a.onupgradeneeded=function(a){a=
a.target.result;console.log(a);a.objectStoreNames.contains(ARTICLE_STORE)||a.createObjectStore(ARTICLE_STORE);a.objectStoreNames.contains(UIDSTORE)||a.createObjectStore(UIDSTORE)}},deleteData:function(a){db1.transaction([ARTICLE_STORE],"readwrite").objectStore(ARTICLE_STORE).delete(a).onsuccess=function(b){console.log(a+" has been removed from your database.")}},clearData:function(){var a=window.indexedDB.open(dbname,dbversion);a.onsuccess=function(b){db2=a.result;db2.transaction([ARTICLE_STORE],
"readwrite").objectStore(ARTICLE_STORE).clear().onsuccess=function(a){console.log("Object Store has been cleared.")}}},manageNotificationListView:function(a,b,e){$("#licontent"+b).fadeOut(300,function(){$(this).remove()})},trackAppClicked:function(a){""!=a&&fetch("/scripts/cms/controller.php?module=subscription&type=notificationAppClicked&url="+a+"&last_sub_id="+last_sub_id,{method:"post"}).catch(function(a){console.error("Inside 1st error:",a)})},displayNumberNotification:function(){licount--;$(".notification-num").text(licount);
0==licount&&(document.getElementById("notf-cont").style.display="none",$(".notification-num").hide(),$(".notification-text").show(),setTimeout(function(){$(".notification-wrapper").hide()},1E3))},getDateFormat:function(a){var b=new Date(a);a=b.getFullYear();var e=b.getMonth(),c=b.getDate(),d=b.getHours();b=b.getMinutes();10>b&&(b="0"+b);e="January February March April May June July August September October November December".split(" ")[e];return e+" "+c+", "+a+", "+d+":"+b+"[IST]"},truncateWords:function(a,
b){return a.split(" ").splice(0,b).join(" ")},openManageScreen:function(a){var b=$(".article-slider ul li").length;0==a?setTimeout(function(){$(".notification-wrapper").hide()},1E3):(0==b?($(".article-slider-wrapper,.article-overlay").addClass("show-popup"),$(".article-slider-container").show(),$(".article-slider-container").css("overflow-y","hidden"),$(".article-slider").hide()):($(".article-slider").find("li").css("width","320px"),$(".article-slider-wrapper,.article-overlay").addClass("show-popup")),
$(".notification-settings-clearbox").hide())},manageOnOff:function(a,b){0==a?($("."+b).removeClass("onstate"),$("."+b).addClass("offstate"),notificationApi.manageEnableDisable(0),notificationApi.clearData(),$(".notification-bell").hide(),$(".notification-bell-inactive").show(),$(".notification-num").hide(),$(".articlelist").remove()):($("."+b).addClass("onstate"),$("."+b).removeClass("offstate"),$(".notification-bell").show(),$(".notification-bell-inactive").hide(),notificationApi.manageEnableDisable(1))},
manageEnableDisable:function(a){localStorage.getItem("web_id");var b=localStorage.getItem("npenglish_subscription_id");if(""!=b&&void 0!=b)fetch("/scripts/cms/controller.php?module=subscription&type=manageEnableDisable&last_sub_id="+b+"&active_status="+a,{method:"post"}).then(function(b){b.text().then(function(b){console.log(b);localStorage.setItem("npenglish_enabled",a);notificationApi.openManageScreen(0)})})["catch"](function(a){console.log("Fetch Error :-S",a)})},detectPrivateWindow:function(){var a=
window.RequestFileSystem||window.webkitRequestFileSystem;a?a(window.TEMPORARY,100,function(a){console.log("Normal Mode")},function(a){console.log("incognito Mode");alert("You are in incognito mode.\nSome of the functionalities may not work.")}):console.log("No such Functions....")},adgebraAdBetweenList:function(a){localStorage.getItem("web_id");var b=localStorage.getItem("npenglish_subscription_id"),e=parseInt(a)+1;console.log(a);if(""!=b&&void 0!=b&&3<=a)fetch("/scripts/cms/controller.php?module=subscription&type=getAdgebraAd&last_sub_id="+
b+"&device_type=2&noAds="+Math.floor(e/3),{method:"post"}).then(function(b){b.text().then(function(b){if(""!=b&&void 0!=b&&null!=b&&(b=JSON.parse(b),3<=a)){if(""!=b[0]&&void 0!=b[0]&&null!=b[0]&&"Campaign Not Found"!=b[0].msgCode){var c=decodeURIComponent(b[0].trackerUrl).replace(/\+/g," "),e=b[0].notificationImage,d=decodeURIComponent(b[0].notificationMessage).replace(/\+/g," ");c="<li id='licontent1'><a href='"+c+"' target='_blank'><div class='article-slider-container' style='height:380px;'><div class='article-slider-thumb' style='text-align:center;'><img src='"+
e+"' style='height: 200px;' alt='' /></div><div class='article-slider-details'><h2 class='article-slider-title'>"+d+"</h2></div></div></a></li>";$("#notification-content > li:nth-child(3)").after(c)}""!=b[1]&&void 0!=b[1]&&null!=b[1]&&"Campaign Not Found"!=b[1].msgCode&&(c=decodeURIComponent(b[1].trackerUrl).replace(/\+/g," "),e=b[1].notificationImage,d=decodeURIComponent(b[1].notificationMessage).replace(/\+/g," "),c="<li id='licontent2'><a href='"+c+"' target='_blank'><div class='article-slider-container' style='height:380px;'><div class='article-slider-thumb' style='text-align:center;'><img src='"+
e+"' style='height: 200px;' alt='' /></div><div class='article-slider-details'><h2 class='article-slider-title'>"+d+"</h2></div></div></a></li>",$("#notification-content > li:nth-child(7)").after(c));""!=b[2]&&void 0!=b[2]&&null!=b[2]&&"Campaign Not Found"!=b[2].msgCode&&(c=decodeURIComponent(b[2].trackerUrl).replace(/\+/g," "),e=b[2].notificationImage,b=decodeURIComponent(b[2].notificationMessage).replace(/\+/g," "),b="<li id='licontent3'><a href='"+c+"' target='_blank'><div class='article-slider-container' style='height:380px;'><div class='article-slider-thumb' style='text-align:center;'><img src='"+
e+"' style='height: 200px;' alt='' /></div><div class='article-slider-details'><h2 class='article-slider-title'>"+b+"</h2></div></div></a></li>",$("#notification-content > li:nth-child(11)").after(b))}})})["catch"](function(a){console.log("Fetch Error :-S",a)})},manageFooterEnableClick:function(a){$(".notification-bell").show();$(".notification-bell-inactive").hide();localStorage.getItem("web_id");var b=localStorage.getItem("npenglish_subscription_id");$(".manage-notification").show();setTimeout(function(){$(".manage-notification").hide()},
5E3);$(".manage-notification-close").on("touchstart click",function(a){$(".manage-notification").hide("slow")});if(""!=b&&void 0!=b)fetch("/scripts/cms/controller.php?module=subscription&type=manageEnableDisable&last_sub_id="+b+"&active_status="+a,{method:"post"}).then(function(b){b.text().then(function(b){console.log(b);localStorage.setItem("npenglish_enabled",a);$("#notification-link").hide()})})["catch"](function(a){console.log("Fetch Error :-S",a)})},updateIndexDb:function(a){var b=window.indexedDB.open(dbname,
dbversion);b.onsuccess=function(e){db1=b.result;var c=db1.transaction([dbname],"readwrite");c.objectStore(dbname).get("subscriptionid").onsuccess=function(b){c.objectStore(dbname).put(a,"subscriptionid")}}},manageNotificationBlock:function(){$(".manage-notification-block-top").show();$("html,body").css("overflow","hidden");setUserCookie("manage_npenglish_notification_block",1,1440,"/","","");var a=setTimeout(function(){$(".manage-notification-block-top").hide();$("html,body").css("overflow","auto")},
1E4);$(".click-close-firefox").on("click",function(b){$(".manage-notification-block-top").hide("slow");$("html,body").css("overflow","auto");clearTimeout(a)});$(document).on("click",".click-close",function(b){$(".manage-notification-block-top").hide();$("html,body").css("overflow","auto");clearTimeout(a)});$(document).on("click",".click-close-firefox",function(b){$(".manage-notification-block-top-firefox").hide();$("html,body").css("overflow","auto");clearTimeout(a)})},createFcmToken:function(a,b){navigator.serviceWorker.ready.then(function(a){service_worker=
a;a.pushManager.subscribe({userVisibleOnly:!0}).then(function(a){a="subscriptionId"in a?a.subscriptionId:a.endpoint.replace("https://fcm.googleapis.com/fcm/send/","");console.log(a+" : New Token Generated");notificationApi.sendTokenToServer(a,b)}).catch(function(a){console.log("An error occurred while retrieving token. ",a)})})},sendTokenToServer:function(a,b){if(""!=b&&void 0!=b)fetch("/scripts/cms/controller.php?module=subscription&type=sendTokenToServer&last_sub_id="+b+"&currentToken="+a,{method:"post"}).then(function(e){e.text().then(function(c){console.log(c);
localStorage.setItem("npenglish_enabled",1);localStorage.setItem("npenglish_subscription_id",b);notificationApi.updateIndexDb(a)})})["catch"](function(a){console.log("Fetch Error :-S",a)})},getUserStatus:function(a){if(""!=a&&void 0!=a)fetch("/scripts/cms/controller.php?module=subscription&type=getNotificationStatus&last_sub_id="+a,{method:"post"}).then(function(b){b.text().then(function(b){console.log(b);3==b&&navigator.serviceWorker.getRegistration().then(function(c){c.unregister().then(function(){localStorage.removeItem("npenglish_subscription_id");
return navigator.serviceWorker.register("/oiframework-sw-web.js?v="+version).then(function(){console.log("Service Worker Registered");notificationApi.createFcmToken(b,a)})}).then(function(a){c!==a})})})})["catch"](function(a){console.log("Fetch Error :-S",a)})},manageSettingsStorage:function(a,b){localStorage.getItem("web_id");var e=localStorage.getItem("npenglish_subscription_id");if(""!=e&&void 0!=e)fetch("/scripts/cms/controller.php?module=subscription&type=manageEnableDisable&last_sub_id="+e+
"&active_status="+a,{method:"post"}).then(function(c){c.text().then(function(c){localStorage.setItem("npenglish_enabled",a);0==a?setUserCookie("npenglish_disabled_val",b,b,"/","",""):(deleteUserCookie("npenglish_disabled_val","/",""),console.log("cookie Deleted......"))})})["catch"](function(a){console.log("Fetch Error :-S",a)})},manageLocalDbInfo:function(a){var b=window.indexedDB.open(dbname,dbversion);b.onsuccess=function(e){db1=b.result;db1.objectStoreNames.contains(dbname)&&db1.transaction([dbname],
"readwrite").objectStore(dbname).put(a,"block_time")}}};0==BROWSER_SUPPORTS&&(document.getElementById("notification-link")&&(document.getElementById("notification-link").style.display="none"),document.getElementById("giz-emailsubscribe")&&$("#giz-emailsubscribe").show());
if(1==BROWSER_SUPPORTS&&0!=chkcookiepolicy){window.addEventListener("load",function(){console.log("Window Loaded...");var a=localStorage.getItem("npenglish_subscription_id");if(""==a||"undefined"==a||null==a)a="";"granted"==Notification.permission&&""!=a&&notificationApi.getUserStatus(a)});try{require(["jquery","bxslider"],function(a){console.log(Notification.permission);var b=localStorage.getItem("npenglish_subscription_id");if(""==b||"undefined"==b||null==b)b="";"granted"==Notification.permission&&
""!=b&&notificationApi.getAllData();var e=getUserCookie("isShown");if("undefined"==typeof e||null==e)notificationApi.detectPrivateWindow(),setUserCookie("isShown",1,24,"/","","");b=localStorage.getItem("npenglish_subscription_id");e=localStorage.getItem("npenglish_enabled");if(""==e||"undefined"==e||null==e)e="";licount=a("ul#not-content li").length;console.log("No Of Notification : "+licount);0==licount?a(".notification-num").hide():a(".notification-num").text(licount).show();var c=getUserCookie("ds_notnow_clicked");
if(""==c||"undefined"==c||null==c)c="";if("default"==Notification.permission){var d=getUserCookie("desktop_bsnotification_seen");"undefined"==typeof d||null==d?(c<notnowclicked_config&&(openNotify=setTimeout(function(){a("div#oiNotification").addClass("shownotf")},8E3)),document.getElementById("notification_bell").style.display="none",setUserCookie("desktop_bsnotification_seen",1,48,"/","","")):(document.getElementById("notification_bell").style.display="block",a(".notification-bell").addClass("ismovement"));
document.getElementById("notification-link")&&a("#notification-link").show();document.getElementById("giz-subscribe")&&a("#giz-subscribe").show()}else if("denied"==Notification.permission)d=getUserCookie("desktop_bsnotification_seen"),"undefined"==typeof d||null==d?(c<notnowclicked_config&&(openNotify=setTimeout(function(){a("div#oiNotification").addClass("shownotf")},8E3)),document.getElementById("notification_bell").style.display="none",setUserCookie("desktop_bsnotification_seen",1,48,"/","","")):
(a(".notification-bell").hide(),a(".notification-bell-inactive").show()),document.getElementById("notification-link")&&a("#notification-link").show(),document.getElementById("giz-unsubscribe")&&a("#giz-unsubscribe").show();else{""==b||"undefined"==b||null==b?a(".notification-bell").hide():1==e?(a(".popup-notification-on-off").addClass("onstate"),a(".popup-notification-on-off").removeClass("offstate"),a(".notification-bell").show(),document.getElementById("notification-link")&&a("#notification-link").hide(),
document.getElementById("giz-emailsubscribe")&&a("#giz-emailsubscribe").show()):(a(".popup-notification-on-off").removeClass("onstate"),a(".popup-notification-on-off").addClass("offstate"),a(".notification-bell-inactive").show(),document.getElementById("notification-link")&&a("#notification-link").show(),document.getElementById("giz-unsubscribe")&&a("#giz-unsubscribe").show());a(".notification-bell").removeClass("ismovement");b=getUserCookie("npenglish_disabled_val");c=localStorage.getItem("npenglish_enabled_time");
if(""==c||"undefined"==c||null==c)c="";console.log(b+" : Cookie Value For Radio Button");if("undefined"==typeof b||null==b){b=c.split("_")[0];var g=c.split("_")[1],p=(new Date).getHours();""!=g&&void 0!=g&&(d=p>=b&&p<g?1:0);0==c||""==c?a("input[name=block-radio][value=0]").attr("checked","checked"):(b=c.split("_"),c=b[0],b=b[1],0==d?a("input[name=block-radio][value=0]").attr("checked","checked"):(a("input[name=block-radio][value=1]").attr("checked","checked"),a("#block-from").removeAttr("disabled"),
a("#block-to").removeAttr("disabled")),a("#block-from option[value="+c+"]").attr("selected","selected"),a("#block-to option[value="+b+"]").attr("selected","selected"));1==e?(a(".notification-bell").show(),a(".notification-bell-inactive").hide()):(a(".notification-bell").hide(),a(".notification-bell-inactive").show())}else a("input[name=block-radio][value="+b+"]").attr("checked","checked"),a(".notification-bell").hide(),a(".notification-bell-inactive").show()}a(".instant-updates-close").on("click",
function(b){b.preventDefault();"denied"==Notification.permission?(a(".notification-bell").hide(),a(".notification-bell-inactive").show()):(document.getElementById("notification_bell").style.display="block",a(".notification-bell").addClass("ismovement"));a("div#oiNotification").removeClass("shownotf");b=getUserCookie("ds_notnow_clicked");b=""==b||"undefined"==b||null==b?parseInt(notnow_clicked)+1:parseInt(b)+1;setUserCookie("ds_notnow_clicked",b,144E3,"/","","")});a("#enable-btn").on("click",function(b){b.preventDefault();
"denied"==Notification.permission?(a(".notification-bell").hide(),a(".notification-bell-inactive").show(),a("div#oiNotification").removeClass("shownotf"),b=getUserCookie("manage_npenglish_notification_block"),"undefined"!=typeof b&&null!=b||notificationApi.manageNotificationBlock()):(a("div#oiNotification").removeClass("shownotf"),1==BROWSER_SUPPORTS&&(notification_source=4,subscribeDevice(),a(".notification-bell").removeClass("ismovement"),a(".notf-overlay").show()))});a(".notification-bell").on("click",
function(){"denied"==Notification.permission?(a(".notification-bell").hide(),a(".notification-bell-inactive").show(),notificationApi.manageNotificationBlock()):"default"==Notification.permission?(1==BROWSER_SUPPORTS&&(subscribeDevice(),a(".notf-overlay").show()),a(".notification-bell").removeClass("ismovement")):(a("body,html").css("overflow","hidden"),notificationApi.openManageScreen(1))});a("#notification_bell_left").on("click",function(){"denied"==Notification.permission?(a(".notification-bell").hide(),
a(".notification-bell-inactive").show(),notificationApi.manageNotificationBlock()):"default"==Notification.permission?(ga("nativeplaneten.send","event","pn-cms","desktop-article","article-left"),1==BROWSER_SUPPORTS&&(notification_source=2,subscribeDevice(),a(".notf-overlay").show()),a(".notification-bell").removeClass("ismovement")):notificationApi.openManageScreen(1)});a(".notification_bell_unsub").on("click",function(){"denied"==Notification.permission?notificationApi.manageNotificationBlock():
notificationApi.openManageScreen(1)});a(".notification-bell-inactive").on("click",function(){"denied"==Notification.permission?notificationApi.manageNotificationBlock():notificationApi.openManageScreen(1)});if(document.getElementById("notify-subscribe"))a("#notify-subscribe").on("click touchstart",function(){ga("nativeplaneten.send","event","Notification_Article","Notification_Desktop","Nativeplanet");"denied"==Notification.permission?notificationApi.manageNotificationBlock():"default"==Notification.permission?
1==BROWSER_SUPPORTS&&(notification_source=3,subscribeDevice(),a(".notf-overlay").show()):0==localStorage.getItem("npenglish_enabled")&&(a("#notification-link").show(),a(".popup-notification-on-off").addClass("onstate"),a(".popup-notification-on-off").removeClass("offstate"),notificationApi.manageFooterEnableClick(1))});a(document).on("click","#closebtn",function(b){b.preventDefault();notificationApi.displayNumberNotification();b=a(this).attr("data-url");var c=a(this).attr("data-index");notificationApi.manageNotificationListView(b,
c,"close");notificationApi.deleteData(b)});a(document).on("click","#notanchor",function(b){b=a(this).attr("href");a(this).attr("data-index");var c=a(this).attr("data-url");window.location.href=b+"?utm_source=pn-&utm_medium=pn-article&utm_campaign=pn-cms";b=b.split("?")[0];notificationApi.trackAppClicked(b);notificationApi.deleteData(c)});a(document).on("click",".popup-notification-on-off",function(b){a(this).hasClass("onstate")?(document.getElementById("notification-link")&&a("#notification-link").show(),
notificationApi.manageOnOff(0,"popup-notification-on-off"),document.getElementById("giz-unsubscribe")&&a("#giz-unsubscribe").show(),document.getElementById("giz-emailsubscribe")&&a("#giz-emailsubscribe").hide()):(document.getElementById("notification-link")&&a("#notification-link").hide(),notificationApi.manageOnOff(1,"popup-notification-on-off"),document.getElementById("giz-emailsubscribe")&&a("#giz-emailsubscribe").show(),document.getElementById("giz-unsubscribe")&&a("#giz-unsubscribe").hide())});
a(document).on("click",".notification-clear",function(b){notificationApi.clearData();a(".notification-text").show();a(".notification-num").hide();a(".articlelist").remove();document.getElementById("notf-cont").style.display="none";licount=0});a(".popup-notification-text").on("click",function(b){b.preventDefault();a(".notification-wrapper").hide()});a(document).on("click",".article-share",function(b){a(this).parent(".article-slider-sharelinks").find(".article-slider-footer").addClass("active")});a(document).on("click",
".article-social-close",function(b){a(".article-slider-footer").removeClass("active")});a(".notification-on-off .on-off-link").click(function(){a(this).parent(".notification-on-off").hasClass("onstate")?(a(this).parent(".notification-on-off").removeClass("onstate"),a(this).parent(".notification-on-off").addClass("offstate"),a(".notification-settings-popup").show()):(a(this).parent(".notification-on-off").addClass("onstate"),a(this).parent(".notification-on-off").removeClass("offstate"),a(".notification-settings-popup").hide())});
a(".notification-settings-heading span").click(function(){a(".notification-settings-popup").hide()});a(".article-popup-close").click(function(){a(".article-slider-wrapper,.article-overlay").removeClass("show-popup");a(".notification-settings-popup").hide();a(".article-slider-wrapper").removeClass("hide-popup");a(".notification-settings-clearbox").hide();a("body,html").css("overflow","")});a(".article-popup-settings").click(function(){a(this).parent().addClass("hide-popup");a(".notification-settings-popup").addClass("show-popup");
a(".notification-settings-popup").show()});a(".notification-settings.notfset").click(function(){a(".notification-settings-popup").removeClass("show-popup");a(".article-slider-wrapper").removeClass("hide-popup");a(".notification-settings-popup").hide()});a(".no").click(function(){a(".notification-settings-clearbox").hide();a(".notification-settings-popup").show()});a(".yes").click(function(){notificationApi.clearData();a(".notification-settings-popup").removeClass("show-popup");a(".article-slider-wrapper").removeClass("hide-popup");
a(".notification-settings-popup").hide();a(".notification-settings-clearbox").hide();a(".article-slider-wrapper,.article-overlay").addClass("show-popup");a(".article-slider-container").show();a(".article-slider").hide();a(".notification-num").hide()});a(".notification-settings-heading a").click(function(){a(".notification-settings-clearbox").show();a(".notification-settings-popup").hide()});a(".notification-settings.clearnotf").click(function(){a(".notification-settings-clearbox").hide();a(".notification-settings-popup").show()});
a(".notification-settings-btn").on("click",function(){if(1==a("input[name='block-radio']:checked").val()){var b=document.getElementById("block-from").value;var c=document.getElementById("block-to").value;var d=b+"_"+c;b==c?(a("#error_msg").html('<p style="color:red;font-size:15px;">Start Time and End Time should not be same.</p>').show(),setTimeout(function(){a("#error_msg").hide()},3E3)):(localStorage.setItem("npenglish_enabled_time",d),notificationApi.manageSettingsStorage(1,d),notificationApi.manageLocalDbInfo(d),
a("#error_msg").html('<p style="color:green;font-size:15px;">Settings data stored successfully.</p>').show(),setTimeout(function(){a("#error_msg").hide()},3E3),a(".notification-bell").show(),a(".notification-bell-inactive").hide())}else 0==a("input[name='block-radio']:checked").val()?(d=a("input[name='block-radio']:checked").val(),localStorage.setItem("npenglish_enabled_time",0),notificationApi.manageSettingsStorage(1,d),notificationApi.manageLocalDbInfo(0),a(".notification-bell").show(),a(".notification-bell-inactive").hide()):
(a("input[name='block-radio']:checked").val(),d=a("input[name='block-radio']:checked").val(),localStorage.setItem("npenglish_enabled_time",0),notificationApi.manageSettingsStorage(0,d),notificationApi.manageLocalDbInfo(0),a(".notification-bell").hide(),a(".notification-bell-inactive").show()),a("#error_msg").html('<p style="color:green;font-size:15px;">Settings data stored successfully.</p>').show(),setTimeout(function(){a("#error_msg").hide()},3E3)});a(".squaredradio input[name='block-radio']").on("click",
function(){1==a(this).val()&&a(this).is(":checked")?(a("#block-from").removeAttr("disabled"),a("#block-to").removeAttr("disabled")):(a("#block-from").attr("disabled",!0),a("#block-to").attr("disabled",!0))});a(document).on("click",".article-slider-footer a",function(b){var c=a(this).attr("class");console.log(c);var d=a(this).attr("data-url"),e=a(this).attr("data-title");switch(c){case "article-slider-whatsapp":whatsapp_social_url=encodeURIComponent(d);window.location.href="whatsapp://send?text="+
encodeURIComponent(e)+" "+whatsapp_social_url;break;case "article-slider-twitter":c=encodeURIComponent(d);e=encodeURIComponent(e);window.open("https://twitter.com/share?url="+c+"&via=nativeplanetin&text="+e,"Share on Twitter","menubar=no,toolbar=no,resizable=no,scrollbars=no,height=400,width=600");break;case "article-slider-facebook":e="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(d),window.open(e,"Share on Facebook","menubar=no,toolbar=no,resizable=no,scrollbars=no,height=400,width=600")}b.preventDefault()})})}catch(a){console.log("Notification Block: "+
a)}}function promisifyRequest(a){return new Promise(function(b,e){function c(){b(a.result);g()}function d(){e(a.error);g()}function g(){a.removeEventListener("complete",c);a.removeEventListener("success",c);a.removeEventListener("error",d);a.removeEventListener("abort",d)}a.addEventListener("complete",c);a.addEventListener("success",c);a.addEventListener("error",d);a.addEventListener("abort",d)})}
function IndexDBWrapper(a,b,e){var c=indexedDB.open(a,b);this.ready=promisifyRequest(c);c.onupgradeneeded=function(a){e(c.result,a.oldVersion)}}
function onPushSubscription(a){$(".notf-overlay").hide();var b=getUserCookie("manage_npenglish_notification");console.log("pushSubscription = ");var e=localStorage.getItem("npenglish_subscription_id"),c=localStorage.getItem("npenglish_enabled");if(""==e||"undefined"==e||null==e)e="";if(""==c||"undefined"==c||null==c)c="";var d=localStorage.getItem("web_id");if(""==d||"undefined"==d||null==d)d="";gsid="subscriptionId"in a?a.subscriptionId:a.endpoint.replace("https://fcm.googleapis.com/fcm/send/","");
console.log(gsid);fetch("/scripts/cms/controller.php?module=subscription&regId="+gsid+"&sys_gen_id="+e+"&notification_source="+notification_source,{method:"post"}).then(function(a){a.text().then(function(a){console.log(a);var c=JSON.parse(a);""==e&&(localStorage.setItem("npenglish_subscription_id",c.id),localStorage.setItem("npenglish_enabled",1));""==d&&localStorage.setItem("web_id",c.wi);if("updated"==c.msg)$(".notification-bell").show(),$(".notification-bell-inactive").hide(),localStorage.setItem("npenglish_enabled",
1),document.getElementById("notification-link")&&$("#notification-link").hide(),document.getElementById("giz-subscribe")&&$("#giz-subscribe").hide(),document.getElementById("giz-emailsubscribe")&&$("#giz-emailsubscribe").show();else if("success"==c.msg){$(".notification-bell").show();if("undefined"==typeof b||null==b)$(".manage-notification").show(),setUserCookie("manage_npenglish_notification",1,1440,"/","",""),setTimeout(function(){$(".manage-notification").hide()},5E3),$(".manage-notification-close").on("click",
function(a){$(".manage-notification").hide("slow")});onRegisterNotify(service_worker);localStorage.setItem("npenglish_enabled",1);document.getElementById("notification-link")&&$("#notification-link").hide();document.getElementById("giz-subscribe")&&$("#giz-subscribe").hide();document.getElementById("giz-emailsubscribe")&&$("#giz-emailsubscribe").show()}window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||
window.msIDBTransaction;window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;window.indexedDB||window.alert("Your browser doesn't support a stable version of IndexedDB.");var g,h=window.indexedDB.open(dbname,dbversion),m=function(a){a.objectStoreNames.contains(dbname)||a.createObjectStore(dbname);a.objectStoreNames.contains(ARTICLE_STORE)||a.createObjectStore(ARTICLE_STORE);a.objectStoreNames.contains(UIDSTORE)||a.createObjectStore(UIDSTORE)};console.log(h);h.onerror=
function(a){console.log("error: ")};h.onsuccess=function(a){g=h.result;console.log("success: "+g);g.setVersion&&g.version!=dbversion&&(g.setVersion(dbversion).onsuccess=function(){m(g)});a=g.transaction([dbname],"readwrite");a.objectStore(dbname).put(gsid,"subscriptionid");a.objectStore(dbname).put(c.id,"server_id")};h.onupgradeneeded=function(a){console.log(a.target.result);m(a.target.result)}})})["catch"](function(a){console.log("Fetch Error :-S",a)})}
function subscribeDevice(){navigator.serviceWorker.ready.then(function(a){service_worker=a;a.pushManager.subscribe({userVisibleOnly:!0}).then(function(a){return onPushSubscription(a)}).catch(function(a){"granted"==Notification.permission?$(".notf-overlay").hide():"default"==Notification.permission?$(".notf-overlay").hide():"denied"==Notification.permission&&$(".notf-overlay").hide();"denied"===Notification.permission?(console.log("Permission for Notifications was denied"),fetch("/scripts/cms/controller.php?module=subscription&type=notificationBlocked&device_type=computer",
{method:"post"}).then(function(a){a.text().then(function(a){console.log(a)})})):console.log("Unable to subscribe to push.",a)})})}
function unsubscribeDevice(){navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){a&&a.unsubscribe().then(function(a){var b=localStorage.getItem("npenglish_subscription_id");if(""==b||"undefined"==b||null==b)b="";""!=b&&fetch("/scripts/cms/controller.php?module=subscription&type=unsubscribe&sys_gen_id="+b+"&website_id=113",{method:"post"}).then(function(a){a.text().then(function(c){console.log(c);c=JSON.parse(c);""==b&&localStorage.setItem("npenglish_subscription_id",
c.id);console.log("Unsubscribed from push: ",a)})})}).catch(function(a){console.log("Unsubscription error: ",a)})}).catch(function(a){console.error("Error thrown while unsubscribing from push messaging.",a)})})}function onRegisterNotify(a){try{a.showNotification("www.nativeplanet.com",{body:"Thank you for subscribing to Nativeplanet News alerts.",icon:"/images/nativeplanet-144.png",vibrate:[300,100,400],tag:"npenglish-welcome",data:{url:"https://www.nativeplanet.com"}})}catch(b){}}
function permissionStatusChange(a){switch(console.log("permissionStatusChange = ",a),a.status){case "denied":console.log("denied");break;case "granted":console.log("granted");break;case "prompt":console.log("prompt")}}
function setUpPushPermission(){navigator.permissions.query({name:"push",userVisibleOnly:!0}).then(function(a){permissionStatusChange(a);a.onchange=function(){permissionStatusChange(this)};navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){return a})["catch"](function(a){console.log("An error occured while calling getSubscription()",a)})})})["catch"](function(a){console.error(a);console.log("Ooops Unable to check the permission , Unfortunately the permission for push notifications couldn't be checked. Are you on Chrome 43+?")})}
function setUpNotificationPermission(){return"denied"===Notification.permission?console.log("Ooops Notifications are Blocked","Unfortunately notifications are permanently blocked. Please unblock / allow them to switch on push notifications."):"default"===Notification.permission?1:void navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){return a})})}
function initialiseState(){return"PushManager"in window?"permissions"in navigator?void setUpPushPermission():void setUpNotificationPermission():1}window.addEventListener("load",function(){1==BROWSER_SUPPORTS&&("granted"==Notification.permission?(console.log("Granted Mode"),1==BROWSER_SUPPORTS&&subscribeDevice()):"default"==Notification.permission?console.log("Default Mode"):"denied"==Notification.permission&&console.log("Denied Mode"))});
